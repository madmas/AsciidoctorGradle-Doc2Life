buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath 'org.asciidoctor:asciidoctor-gradle-plugin:1.5.3'
        classpath 'org.asciidoctor:asciidoctorj-pdf:1.5.0-alpha.16'
        classpath 'com.github.jruby-gradle:jruby-gradle-plugin:0.1.11'
        classpath 'com.github.ben-manes:gradle-versions-plugin:0.13.0'
    }
}

apply plugin: 'org.asciidoctor.convert'
apply plugin: 'com.github.jruby-gradle.base'
apply plugin: 'org.asciidoctor.gradle.asciidoctor'
apply plugin: 'com.github.ben-manes.versions'

apply plugin: 'groovy'
apply plugin: 'java'

repositories{
    jcenter()
}

dependencies{
    testCompile group: 'junit', name: 'junit', version: '4.11'
    testCompile "org.codehaus.groovy:groovy-all:2.4.1"
}

asciidoctor {
    dependsOn jrubyPrepareGems

    gemPath = jrubyPrepareGems.outputDir
  
    options doctype: 'book'

	sourceDir = new File('src/doc')
	backends = ['html', 'pdf']
	
    attributes  'source-highlighter': 'coderay',
                'coderay-linenums-mode': 'table',
                toc: 'right',
                linkattrs: true,
                encoding: 'utf-8',
                pagenums: '1',
                'product-version' : project.version

    resources {
        from('src/doc/') {
             include '**/*.png'
             include '**/*.jpg'
        }
    }
}

asciidoctor.dependsOn test
